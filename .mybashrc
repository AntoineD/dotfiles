#!/usr/bin/env bash
################################################################################
# prompt
# PS1="\h\w : "
_PS1='\[\033[01;31m\]\h \[\033[01;34m\]\w\[\033[00m\]'
PS1=$_PS1'\n'

# disable ctrl-s that freezes the shell
stty ixany
stty ixoff -ixon

################################################################################
# alias
alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias l='ls -AFG --color'
alias ll='ls -AFGl --color'
alias kk='ll'
alias lt='ls -AFGlrt --color'
alias h='history'
alias j="jobs -l"
alias pu="pushd"
alias po="popd"
alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'
alias dir='ls -ba'
alias ss="ps -aux"
alias dot='ls .[a-zA-Z0-9_]*'
alias m="less"
alias v="vim"

# ignore some commands in history
export HISTIGNORE="&:ll:l:[bf]g:exit:open"

# ... and ignore same sucessive entries.
export HISTCONTROL=ignoreboth:erasedups

export HISTSIZE=10000

# path short cuts
export CDPATH=.:~

# encoding
export LANG=en_US.UTF-8
export LC_ALL=$LANG
export LANGUAGE=$LANG

# misc
export GREP_OPTIONS='--color=auto'

# python start file
if [[ -f ~/.pythonrc ]]; then
    export PYTHONSTARTUP=~/.pythonrc
fi
################################################################################
. $HOME/.shoptrc

################################################################################
# pip bash completion start
#_pip_completion()
#{
#    COMPREPLY=( $( COMP_WORDS="${COMP_WORDS[*]}" \
#                   COMP_CWORD=$COMP_CWORD \
#                   PIP_AUTO_COMPLETE=1 $1 ) )
#}
#complete -o default -F _pip_completion pip
# pip bash completion end

################################################################################
# VIRTUALENV
# if [[ $HOSTNAME == pdev1* ]]; then
#     export VIRTUAL_ENV_DISABLE_PROMPT=1
# fi

################################################################################
# MODULES
if [[ -f ~/local/Modules/default/init/bash ]]; then
    .  ~/local/Modules/default/init/bash
fi

module load scons/2.1.0
module load vim/7.3-918
# module load syntastic/current

################################################################################
module load bash-completion/1.3
if [[ $PS1 && -d ~/local/bash-completion ]]; then
    . ~/local/bash-completion/1.3/etc/bash_completion
fi

################################################################################
module load git/1.8.2
. $GIT_CONTRIB_PATH/completion/git-completion.bash 
. $GIT_CONTRIB_PATH/completion/git-prompt.sh

if type __git_ps1 >/dev/null 2>&1; then
        PS1=$_PS1' \[\033[01;31m\]$(__git_ps1 "(%s) ")\[\033[00m\]\n'
fi

################################################################################
# cdtng helper
cdtng() { eval `$1 --version $2 --setenvironment $3`; }
export -f cdtng
